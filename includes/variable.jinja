[% macro repo_url() -%]
  {{ repo_host }}/{{ repo_namespace }}/{{ repo_name }}
[%- endmacro %]

[% macro repo_base_url() -%]
  [% if repo_host_type == 'github.com' -%]
    {{ repo_url() }}
  [%- elif repo_host_type == 'gitlab.com' or repo_host_type == 'gitlab-self-managed' -%]
    {{ repo_url() }}/-
  [%- endif %]
[%- endmacro %]

[% macro page_base_url() -%]
  [% if repo_host_type == 'github.com' -%]
    {{ repo_namespace }}.github.io/{{ repo_name }}
  [%- elif repo_host_type == 'gitlab.com' or repo_host_type == 'gitlab-self-managed' -%]
    [%- set repo_namespace_root = repo_namespace.split("/")[0] -%]
    {{ repo_namespace_root }}.{{ page_host }}{{ repo_namespace | replace(repo_namespace_root, "", 1) }}/{{ repo_name }}
  [%- endif %]
[%- endmacro %]

[% macro ci_badge() -%]
  [% if repo_host_type == 'github.com' -%]
    [![CI Status](https://{{ repo_url() }}/actions/workflows/ci.yml/badge.svg?branch=main)](https://{{ repo_url() }}/actions/workflows/ci.yml)
  [%- elif repo_host_type == 'gitlab.com' or repo_host_type == 'gitlab-self-managed' -%]
    [![pipeline status](https://{{ repo_url() }}/badges/main/pipeline.svg)](https://{{ repo_base_url() }}/commits/main)
  [%- endif %]
[%- endmacro %]

[% macro coverage_badge() -%]
  [![Coverage](https://img.shields.io/endpoint?url=https://{{ page_base_url() }}/reports/coverage/coverage_badge.json)](https://{{ page_base_url() }}/reports/coverage)
[%- endmacro %]

[% macro license_badge() -%]
  [% if repo_host_type == 'github.com' -%]
    [![GitHub](https://img.shields.io/github/license/{{ repo_namespace }}/{{ repo_name }})]
  [%- elif repo_host_type == 'gitlab.com' or repo_host_type == 'gitlab-self-managed' -%]
    [![GitLab](https://img.shields.io/gitlab/license/{{ repo_namespace }}/{{ repo_name }}?gitlab_url=https%3A%2F%2F{{ repo_host }})]
  [%- endif -%]
  (https://{{ repo_base_url() }}/blob/main/LICENSE)
[%- endmacro %]
